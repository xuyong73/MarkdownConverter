# Markdown 转换器 (MarkdownConverter) 

## 概述

Markdown 转换器是一款基于 WPF (Windows Presentation Foundation) 开发的桌面应用程序，专为需要将 Markdown 文档转换为多种格式的用户设计。该程序集成了 Pandoc 文档转换引擎和 WebView2 渲染组件，提供了现代化的用户界面和强大的文档处理能力。
![MarkdownConverter](https://github.com/xuyong73/MarkdownConverter/blob/main/MainForm.png)

## 核心功能

### 1. 实时预览转换
- **双面板设计**：左侧为 Markdown 编辑器，右侧实时显示转换后的 HTML 预览
- **实时更新**：点击"转换"按钮即可立即查看转换效果
- **语法高亮**：支持 Markdown 各种语法元素的视觉区分

### 2. 多格式导出支持
- **Markdown 文件 (.md)**：保持原始格式导出
- **HTML 文件 (.html)**：生成完整的 HTML 文档，包含内联 CSS 样式
- **Word 文档 (.docx)**：通过 Pandoc 转换为专业的 Word 格式

### 3. 丰富的 Markdown 语法支持
- **标题**：支持 # 至 ###### 级标题
- **列表**：有序列表、无序列表和任务列表
- **任务列表**：支持 [ ] 未完成和 [x] 已完成状态标记
- **链接和图片**：支持内联和引用式链接，图片路径自动解析
- **代码块**：支持行内代码和代码块，带语法高亮
- **数学公式**：支持 LaTeX 数学公式（$...$ 格式）
- **表格**：支持标准 Markdown 表格
- **引用**：支持块引用格式

### 4. 高级特性
- **暗色/亮色主题切换**：一键切换界面主题，适配不同使用环境
- **图片路径自动处理**：支持相对路径图片的自动解析和映射
- **拖拽上传**：支持直接拖拽 .md 文件到编辑器
- **右键粘贴**：编辑器支持右键菜单粘贴操作
- **智能空行处理**：自动优化列表和文本间的空行排版

## 技术架构

### 核心组件
1. **WPF 界面框架**：提供现代化的桌面应用界面
2. **WebView2**：基于 Edge 的现代 Web 渲染引擎
3. **Pandoc**：强大的文档转换工具（需要单独安装）
4. **.NET 10.0**：最新的 .NET 平台支持

### 关键技术特性
- **异步处理**：使用 async/await 实现非阻塞的文档转换
- **进程管理**：通过 Process 类调用 Pandoc 命令行工具
- **线程安全**：使用 SemaphoreSlim 控制并发转换数量
- **内存优化**：临时文件自动清理，避免资源泄露

## 使用流程

### 基本使用
1. **启动程序**：双击运行 MDConv.exe
2. **输入内容**：在左侧编辑器输入或粘贴 Markdown 文本
3. **转换预览**：点击"转换"按钮，右侧显示格式化结果
4. **导出文件**：点击"保存文件"，选择格式和保存位置

### 高级功能
- **打开文件**：通过命令行参数直接打开 .md 文件
- **图片处理**：在 Markdown 文件所在目录放置图片，程序自动解析相对路径
- **主题切换**：点击"切换样式"按钮切换明暗主题
- **任务统计**：自动统计任务列表完成情况

## 依赖要求

### 运行环境
- **操作系统**：Windows 7 或更高版本
- **.NET 运行时**：.NET 10.0 Runtime
- **WebView2 Runtime**：自动安装或已预装

### 可选依赖
- **Pandoc**：用于高级格式转换（Word 导出等）
  - 安装方式：从 pandoc.org 下载安装
  - 用途：Markdown → HTML → Word 的完整转换链

## 特色亮点

### 用户体验
- **直观的双面板设计**：编辑与预览同步显示
- **流畅的交互**：按钮状态管理，加载提示
- **错误处理**：友好的错误提示和异常处理
- **响应式布局**：窗口大小自适应

### 技术优势
- **高性能渲染**：WebView2 提供流畅的 HTML 渲染
- **稳定可靠**：异步处理避免界面卡顿
- **扩展性强**：基于 Pandoc 的强大转换能力
- **轻量级**：核心功能精简，资源占用低

## 应用场景

### 适用人群
- **技术文档编写者**：编写技术文档、README 文件
- **内容创作者**：博客文章、技术教程编写
- **学生和教师**：课件制作、作业提交
- **程序员**：代码文档、项目说明

### 使用场景
- **文档编写**：实时预览 Markdown 格式效果
- **格式转换**：将 Markdown 转换为 Word 文档
- **内容发布**：生成 HTML 用于网页发布
- **学习工具**：学习 Markdown 语法和格式规范

## 故障排除

### 常见问题
1. **Pandoc 未安装**：无法导出 Word 文档
   - 解决：安装 Pandoc 并添加到 PATH
2. **WebView2 初始化失败**：无法显示预览
   - 解决：安装 WebView2 Runtime
3. **图片无法显示**：路径解析错误
   - 解决：确保图片与 .md 文件在同一目录

### 日志和调试
- **错误提示**：程序会显示详细的错误信息
- **异常捕获**：所有关键操作都有异常处理
- **状态反馈**：按钮状态变化提供操作反馈

## 版本信息

- **开发框架**：.NET 10.0 Windows 7.0
- **UI 框架**：WPF (Windows Presentation Foundation)
- **WebView2 版本**：1.0.3650.58
- **应用程序名称**：MDConv

## 总结

Markdown 转换器是一款功能强大、界面美观的文档处理工具，它将 Markdown 的简洁性与 Word 的专业性完美结合。无论是日常文档编写还是专业内容制作，都能提供流畅的使用体验和高质量的输出结果。程序采用现代化的技术栈，注重用户体验和性能优化，是处理 Markdown 文档的理想选择。
